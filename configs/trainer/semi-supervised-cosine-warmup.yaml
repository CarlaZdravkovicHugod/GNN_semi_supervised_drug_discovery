defaults:
  - _self_

method: semi-supervised-ensemble

train:
  total_epochs: 1500
  validation_interval: 10
init:
  _target_: trainer.SemiSupervisedEnsemble
  supervised_criterion:
    _target_: torch.nn.MSELoss
  optimizer:
    _target_: torch.optim.AdamW
    _partial_: true
    lr: 0.001
    weight_decay: 0.01  # Increased weight decay for better regularization
  scheduler:
    _target_: torch.optim.lr_scheduler.CosineAnnealingWarmRestarts
    _partial_: true
    T_0: 100  # Restart every 100 epochs
    T_mult: 2  # Double the restart period after each restart
    eta_min: 0.00001  # Minimum learning rate
  rampup_scheduler:
    _target_: torch.optim.lr_scheduler.StepLR
    _partial_: true
    step_size: 30  
    gamma: 1.2

  unsupervised_weight: 1.0  # Weight for unsupervised consistency loss (default enabled)
  use_mean_teacher: true     # Use Mean Teacher (EMA teacher models) for pseudo-labels
  ema_decay: 0.999           # EMA decay rate for teacher model updates
